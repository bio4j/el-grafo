<!doctype html>

<meta charset="utf-8">
<title>json data to representation</title>
<link rel="stylesheet" type="text/css" href="css/style.css">

<script src="scripts/lib/d3.js" charset="utf-8"></script>
<script src="scripts/lib/graphlib.js"></script>
<script src="http://cpettitt.github.io/project/dagre-d3/latest/dagre-d3.js"></script>

<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://www.trendskitchens.co.nz/jquery/contextmenu/jquery.contextmenu.r2.js"></script>

<script src="scripts/alg/topsort.js"></script>
<script src="scripts/alg/tarjan.js"></script>
<script src="scripts/alg/components.js"></script>
<script src="scripts/alg/dijkstra.js"></script>
<script src="scripts/alg/dijkstraAll.js"></script>
<script src="scripts/alg/findCycles.js"></script>
<script src="scripts/alg/floydWarshall.js"></script>
<script src="scripts/alg/isAcyclic.js"></script>
<script src="scripts/alg/postorder.js"></script>
<script src="scripts/alg/preorder.js"></script>
<script src="scripts/alg/prim.js"></script>

<body onLoad="draw();">
<div id="attach">
  <svg id="svg-dagred3graph" width=700 height=400>
    <g transform="translate(20, 20)"/>
  </svg>



<!--   <svg id="svg-routemap" width=450 height=350>
    <g transform="translate(20, 20)"/>
  </svg>
</div> -->

<!-- <div id="tooltip" class="hidden">
  <p><strong>Important Label Heading</strong></p>
  <p><span id="value">100</span>%</p>
</div> -->

    <div class="contextMenu" id="cntxtMenu">
        <ul>
            <li id="neighbour"> Select its NEIGHBOUR </li>
            <li id="predecessors"> Select its PREDECESSORS </li>
            <li id="strongly-connected"> strongly-connected </li>
            <li id="successors"> Select its SUCCESSORS </li>
            <!-- <li id="strongComponents"> Select STRONG COMPONENT community </li> -->
        </ul>
    </div>

<script>

var zoom = d3.behavior.zoom();

  var graphRE = /[?&]graph=([^&]+)/;
var graphMatch = window.location.search.match(graphRE);
if (graphMatch) {
  inputGraph.value = decodeURIComponent(graphMatch[1]);
}
var debugAlignmentRE = /[?&]alignment=([^&]+)/;
var debugAlignmentMatch = window.location.search.match(debugAlignmentRE);
var debugAlignment;
if (debugAlignmentMatch) debugAlignment = debugAlignmentMatch[1];


function draw(isUpdate) {

// 1-MODEL/DATA/FROM/SERVICE
// Loading GO data from local file after and transforming json initial structure.
d3.json("data/GO-multiple.json", function(jsonGO) {

    svgGraph = d3.select("svg g");

    var module = jsonGO.label;
    var properties = jsonGO.propertyTypes;


    // 2-ADAPT/JSON/DATA/GRAPHLIB
    // Transforming json vertex structure with a .map function:
    console.log("Original json structure of vertexTypes from GO file:")
    console.log(jsonGO.vertexTypes)

    var newVertex = jsonGO.vertexTypes.map(function(x) {
          return {
            id: x,
            value: { module: jsonGO.label, label: x, propertyTypes: properties  }            
            };
        });
    
    console.log("Transformed structure of vertexTypes for Graphlib:")
    console.log(newVertex);

    //////

    // Transforming json edges structure with a .map function:
    console.log("Original json structure of edgeTypes from GO file:")
    console.log(jsonGO.edgeTypes)

        var newEdges = jsonGO.edgeTypes.map(function(x) {
          return {
            id: x.label,
            u: x.sourceType,     
            v: x.targetType,
            value: { module: jsonGO.label, label: x.label, inArity: x.inArity, outArity: x.outArity, propertyTypes: properties }            
          };
        });
    
    console.log("Transformed structure of edgeTypes for Graphlib:")
    console.log(newEdges);


  ////////


  // Using the GRAPHLIB GRAPH as input for DAGRE-D3:
  var renderer = new dagreD3.Renderer();
  var graph = dagreD3.json.decode(newVertex, newEdges);
    
  //alter the drawNodes function:
    var oldDrawNodes = renderer.drawNodes();
  renderer.drawNodes(function(graph, root) {

    console.log(newVertex);
    console.log(d3.selectAll("svgNodes"));

    var svgNodes = oldDrawNodes(graph, root);
    svgNodes.attr("id", function(u) { return  u });
    return svgNodes;
  });


  //alter the drawEdges function:
  var oldDrawEdge = renderer.drawEdgePaths();
  renderer.drawEdgePaths(function(graph, root) {

    console.log(d3.selectAll("svgEdgePaths"));

    var svgEdgePaths = oldDrawEdge(graph, root);
    svgEdgePaths.attr("id", function(e) { return  e })
    return svgEdgePaths;

  });

  // Multiple lines with different tension:
/*  vis.selectAll("path")
    .data([0, 0.2, 0.4, 0.6, 0.8, 1])
  .enter().append("svg:path")
    .attr("d", function(d) { return line.tension(d)(data); })
    .style("stroke", d3.interpolateRgb("teal", "lightblue"));
*/

//////////////////////////////////////////////////////////////////////////////////////////////////////  
  svg = d3.select("svg");
console.log("svg", svg);

      // Custom transition function
    function transition(selection) {
      return selection.transition().duration(200);
    }
    
    isUpdate && renderer.transition(transition);

    renderer.zoom(function (graph, svg) {
      return zoom.on('zoom', function() {
        svg.attr('transform', 'translate(' + d3.event.translate + ')scale(' + d3.event.scale + ')');
      });
    });




//////////////////////////////////////////////////////////////////////////////////////////////////////  



  //Configuring the layout:
  var layout = dagreD3.layout()
                //.nodeSep(50)  //50=default
                //.edgeSep(10)
                //.rankSep(20);   //Separation between levels, childs
                .rankDir("LR"); //TB:top-to-bottom / BT:bottom-to-top / LR:left-to-right / RL:right-to-left 

  
  //Configuring the renderer-original:
  var renderinglayout = renderer.layout(layout)
              // .edgeTension(.5)
              .edgeInterpolate("bundle")  // Bundle, linear, step-after, basis, cardinal, monotone..
              
              .run(graph, svgGraph);

/*  //Configuring the renderer-modified:
  var renderinglayout = renderer.layout(layout)
              // .edgeTension(.9)   //1=default
              .edgeInterpolate("bundle")  // Bundle, linear, step-after, basis, cardinal, monotone..
              
              .run(graph, d3.select("svg g"));*/
  
  //



    // Zoom and scale to fit
    var zoomScale = zoom.scale();
    var graphWidth = renderinglayout.graph().width + 80;
    var graphHeight = renderinglayout.graph().height + 40;
    var width = parseInt(svg.style('width').replace(/px/, ''));
    var height = parseInt(svg.style('height').replace(/px/, ''));
    
    zoomScale = Math.min(width / graphWidth, height / graphHeight);
    
    var translate = [(width/2) - ((graphWidth*zoomScale)/2), (height/2) - ((graphHeight*zoomScale)/2)];
    zoom.translate(translate);
    zoom.scale(zoomScale);
    zoom.event(isUpdate ? svg.transition().duration(500) : svgGraph);


/*  setInterval(function() {

    draw(true);
  }, 2000);*/

   renderinglayout.eachNode(function(u, value) {
       console.log("VertexTypes " + u + ": " + JSON.stringify(value));
   });
    
  renderinglayout.eachEdge(function(e, u, v, value) {
     console.log("EdgeTypes " + e + ": " + JSON.stringify(value));
  });



   //Binding Nodes&Edges DATA to the graph by iterating over the generated svg adding ATTRIBUTES:
   //Maybe I need data-attribute instead: http://stackoverflow.com/questions/13188125/d3-add-multiple-classes-with-function

    d3.selectAll(".edgePath.enter")
      .data(newEdges)
      .attr("u", function(d) {
                  return d.u
              })
      .attr("v", function(d) {
                  return d.v
              })
      .attr("inArity", function(d) {
                  return d.value.inArity
              })
      .attr("outArity", function(d) {
                  return d.value.outArity
              })
      .attr("label", function(d) {
                  return d.value.label
              })
      .attr("module", function(d) {
            return d.value.module
              })
      .attr("propertyTypes", function(d) {
            return d.value.propertyTypes
              });


    d3.selectAll(".node.enter")
      .data(newVertex)
      .attr("module", function(d) {
                  return d.value.module
      })           
      .attr("label", function(d) {
                  return d.value.label
      })
      .attr("propertyTypes", function(d) {
      return d.value.propertyTypes
        })
      // .call(d3.behavior.drag())
      ;

    //TO DO in general: convert as much as possible on functions so the node/edges attributes can change in the future with no need of updating the code.



////////////////////////////////////////////////////////////

text = d3.select("body")
          .append("p")
          .text("Dagre-d3 graph representation: '" + module + "' module")
          .style("text-transform", "uppercase");

      d3.select("body")
          .append("p")
          .text("Nº of VERTEX loaded: " + graph.order())
          .append("p")
          .text("Nº of EGES loaded: " + graph.size());


////////////////////////////////////////////////////////////


    // A. SOME DIAGRAPH FEATURES:
    console.log("Number of VERTEX on the Graph: " + graph.order());
    console.log("Number of EDGES on the Graph: " + graph.size());
    

    // EDGES/NODE LIST (general: all edges)
    console.log("All graph vertex: " + graph.nodes());
    console.log("All graph edges: " + graph.edges());


    // SUCCESORS, PREDECESSORS & NEIGHBORS -> LOCAL (node:node)
    console.log(graph.successors("SubOntologies"));
    console.log(graph.predecessors("GoSlims"));
    console.log(graph.neighbors("GoTerm"));


    // SOURCES, SINKS -> GLOBAL (general:node)
    console.log("Graph sources: " + graph.sources()); // There's no source on the graph due the self-linking GoTerm node
    console.log("Graph sinks: " + graph.sinks());


    // EXISTENCE OF EDGE (edge:true/false)
    console.log(graph.hasEdge("GoSlim"));

    // SOURCE, TARGETS & INCIDENTS -> LOCAL  (edge:nodes)
     // console.log(graph.source("PositivelyRegulates"));
     console.log(graph.target("GoSlim"));
     console.log(graph.incidentNodes("SubOntology")) //source+target of the edge

    console.log(graph.inEdges("GoSlims")); //all edges going in node10
    console.log(graph.inEdges("SubOntologies")); //all edges going in node10


    ///////


    // B. SOME ALGOS FEATURES:

    // TARJAN: STRONGLY CONNECTED COMPONENTS
     console.log("tarjan algo:")
     console.log("finds all strongly connected components in the directed graph")

     console.log(tarjan(graph))
     //Array of components, each of them is itself an array with the ids. It gives lots of 1-array objetcs when there are no strongly connected components.


     // IS ACYCLIC, FIND CLYCLES
    // console.log("isAcyclic?")
     // console.log(isAcyclic(graph));    //Gives TRUE if the graph has no cycles and returns false if it does. -ERROR: if there are cycles gives Exception isntead of False.
     
     // alg.findCycles(graph)
     console.log("findCycles algo:")
     console.log("all nodes that are part of a cycle")
     console.log(findCycles(graph)); //Returns all nodes that are part of a cycle-> Arrays of these cycles if there are more.


     // TOPSORT: TOPOLOGICAL SORTING
     // var alg = require("graphlib").alg;
     // var topsort = require("graphlib").alg.topsort.
     // console.log(topsort(graph));  // If the graph has a cycle it is impossible to generate such a list and CycleException is thrown. ojo! cycles include self-linking nodes


     // DIJKSTRA & FLOYDWARSHALL: SHORTEST PATH
     // alg.dijkstra(g, source, [weightFunc], [incidentFunc])
     // console.log(dijkstra(graph, "GoTerm"));      //ERROR: anonymous function (in the js alg file)
     // alg.dijkstraAll(g, [weightFunc], [incidentFunc])
     // console.log(dijkstraAll(g));        //ERROR: anonymous function (in the js alg file)
     // alg.floydWarshall(g, [weightFunc], [incidentFunc])
     // console.log(floydWarshall(graph)); //Si funciona, xo da lista infinita de cosas

     // ALL CONNECTED COMPONENTS -----ERROR
     // console.log(components(g));    //NO FUNCIONA: anonymous function (in the js alg file)


////////////////////////////////////////////////////////////


/*    // TEST1
    // nodes on click! Alert windows just to test everything is working or not:
    d3.selectAll(".node rect")
         .on("click", function(u, value) {
             console.log( "\n" + "Vertex '" + u + "'\n" + "My neighbors nodes are '" + graph.neighbors(u) + "'" + "\n" + "Module: '" + graph.node(u).module + "' & PropertyTypes: '" + graph.node(u).propertyTypes + "'")
          });*/



/*    //Trying to select by "id"
    d3.selectAll(".node.enter#GoTerm")
          .selectAll("rect")
          .style("fill", "red");  // works fine!*/

/*    //Trying to select by "id"
    d3.selectAll("#GoTerm")
          // .select("rect")
          .style("stroke", "red");  // works fine!*/

/*    //Trying to select by "id"
    d3.selectAll(".node.enter#SubOntologies")          
          .selectAll("rect")
          .style("fill", "brown");  // works fine*/

/*    //Trying to select by "id"
    var idd = d3.selectAll(".node.enter").attr("id"); // worng, just selects the attribute of the first element 
    d3.selectAll("#"+idd)          
          .selectAll("rect")
          .style("fill", "brown");   */

/*    //Trying to select by "id"
    d3.selectAll(".node.enter").each( function(d, i) {
        console.log( d3.select(this).attr("id") );        // works fine!
    });*/

/*    //Trying to select by "id"
    d3.selectAll(".node.enter").each( function(d, i) {
        idSelection = d3.select(this).attr("id");
    
        d3.selectAll("#"+idSelection)          
          .selectAll("rect")
          .style("fill", "brown");                      // works fine!

    });*/


/*     //Trying to select by "id"
    d3.selectAll(".node.enter").each( function(d, i) {
        
        idSelection = d3.select(this)
        graphStuff = graph.successors(idSelection).attr("id");
    
        console.log(graphStuff)

        d3.selectAll("#"+idSelection)          
          .selectAll("rect")
          .style("fill", "brown");          

    });  */


    
/* 
    //Trying to select by "id"
    idVertex = d3.selectAll("#GoSlims").attr("id")
 
    idSucessorsVertex = graph.successors(idVertex)
    idPredecessorsVertex = graph.predecessors(idVertex)
    idNeighborsVertex = graph.neighbors(idVertex)
    console.log(idNeighborsVertex)*/

/*    d3.selectAll("#"+ idPredecessorsVertex) 
      .selectAll("rect")
      .style("fill", "yellow");                     // works fine!*/
    
/*    d3.selectAll("#"+ idNeighborsVertex)      //by id just selects one. I might need a filter function
      .selectAll("rect")
      .style("fill", "red");                     // works fine!*/


/*
  // Understanding filtering selections
    d3.selectAll(".node.enter")
                    .filter(function(d) { 
                        selectingThis = d3.select(this)
                        if (selectingThis.attr("id") == idPredecessorsVertex ) {
                           console.log(selectingThis.attr("id"))     // returns #GoTerm

                        selectingThis.selectAll("rect")
                                         .style("fill", "green");     // works fine!  
                        }
                    })
 
 console.log(graph.predecessors("GoSlims"))



*/
              



/*  // Understanding filtering selections
  d3.selectAll(".node.enter")
              .filter(function(d) { 
                  selectingThis = d3.select(this)
                  // myArray = JSON.stringify(["GoSlims", "GoTerm"])
                  myArray = ["GoSlims", "GoTerm"]
                  singleElement = "SubOntologies"
                 
                  if (selectingThis.attr("id") == "SubOntologies"  || selectingThis.attr("id") == "GoSlims" ) {
                      
                      console.log(selectingThis.attr("id"))  
                      selectingThis.selectAll("rect")
                                   .style("fill", "red");         
                  }
                  
                  else { console.log("buuu") }              // WORKS!! :D
              })*/
               

/*  // Understanding filtering selections-comparison with MULTIPLE elements
  d3.selectAll(".node.enter")
              .filter(function(d) { 
                  selectingThis = d3.select(this)
                  // myArray = JSON.stringify(["GoSlims", "GoTerm"])
                  myArray = ["GoSlims", "GoTerm"]
                  singleElement = "SubOntologies"
                  cosaRara = selectingThis.attr("id")
                  
                  //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                  if (myArray.indexOf(cosaRara) >= 0)  {
                      
                      console.log(selectingThis.attr("id"))  
                      selectingThis.selectAll("rect")
                                   .style("fill", "red");         
                  }
                  
                  else { console.log("buuu") }              // WORKS!! :D
              })

*/

/*  // Understanding filtering selections
  d3.selectAll(".node.enter")
              .filter(function(d) { 
                  selectingThis = d3.select(this)
                  selectingThisId = selectingThis.attr("id")

                  myArray = ["GoSlims", "GoTerm"]
                  
                  //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                  if (myArray.indexOf(selectingThisId) >= 0)  {
                      
                      console.log(selectingThisId)  
                      selectingThis.selectAll("rect")
                                   .style("fill", "red");         
                  }
                  
                  else { console.log("buuu") }              // WORKS!! :D
              })*/


/*if (['banana', 'lemon', 'mango', 'pineapple'].indexOf(fruit) >= 0) {
  .......
}*/

/*
    idVertex = d3.selectAll("#GoSlims").attr("id")

    idSucessorsVertex = graph.successors(idVertex)
    idPredecessorsVertex = graph.predecessors(idVertex)
    idNeighborsVertex = graph.neighbors(idVertex)

  // all together: graphlib features + filter + arrays
  d3.selectAll(".node.enter")
              .filter(function(d) { 
                  selectingThis = d3.select(this)
                  selectingThisId = selectingThis.attr("id")

                  myArray = idNeighborsVertex
                  
                  //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                  if (myArray.indexOf(selectingThisId) >= 0)  {
                      
                      console.log(selectingThisId)  
                      selectingThis.selectAll("rect")
                                   .style("fill", "orange");         
                  }
                  
                  else { console.log("buuu") }              // WORKS!! :D
              })

    console.log(idNeighborsVertex)

    //NOTE: for an in/out switch button i should access the successors/predecessors i times (i = degree)


*/


    //TOOLTIPS WORLD:

    //1. Default browser tooltip
/*    d3.selectAll(".node rect")
        .append("title")
        .text(function(u) {
              return "Click to see '" + u + "'' Neighbor vertex";       //WORKS :)
        });*/



    //2. SVG Element Tooltips
    d3.selectAll(".node rect")
        .style("fill", "teal")
        .on("mouseover", function(d) {
        var xPosition = parseFloat(d3.select(this).attr("x")) + d3.select(this)[0][0].getCTM().e;      
        var yPosition = parseFloat(d3.select(this).attr("y")) + d3.select(this)[0][0].getCTM().f;

        // console.log(xPosition);
        // console.log(yPosition);
        
        ParentNode = d3.select(this)[0][0].parentNode;
        // console.log(ParentNode);
        ParentNodeID = ParentNode.id;
        // console.log(ParentNodeID);

        svgGraph.append("text")
              .attr("id", "tooltip")
              .attr("x", xPosition + 50)
              .attr("y", yPosition -30)
              .attr("text-anchor", "middle")
              .attr("font-family", "sans-serif")
              .attr("font-size", "11px")
              .attr("font-weight", "bold")
              .attr("fill", "brown")
              .text(function(u) {                
                    return "Click to see '" + ParentNodeID + "'' Neighbor vertex";     
              });
         })

        .on("mouseout", function() {
              d3.select("#tooltip").remove()
        });

        //NOTE; when working with ".node" class the graph features dont work any more. Everything must be done with ".node rect", and accessing the data through .parentNode when neeeded.
    

/*    //3. HTML div Tooltips
    d3.selectAll(".node rect")
         .on("mouseover", function(d) {

          //Get this bar's x/y values, then augment for the tooltip
          var xPosition = parseFloat(d3.select(this).attr("x"));
          var yPosition = parseFloat(d3.select(this).attr("y"));

          //Update the tooltip position and value
          d3.select("#tooltip")
            .style("left", xPosition + "px")
            .style("top", yPosition + "px")           
            .select("#value")
            .text(function(u) {
                return "Click to see '" + u + "'' Neighbor vertex";     
             });
         
          //Show the tooltip
          d3.select("#tooltip").classed("hidden", false);

         })

         .on("mouseout", function() {
         
          //Hide the tooltip
          d3.select("#tooltip").classed("hidden", true);

          });*/


////////////////////////////////////

//Parameters for context menu
var mySelectionCMenu;
var id;


  d3.selectAll(".node rect")
       .on("mousedown", function(u, value) {
      mySelectionCMenu = u;
      id = d3.select(this);

      // UPDATE to normal status
      d3.selectAll(".node rect")
         .attr("transform", "scale(1)")
         .style("fill", "red")
         .style("opacity", .4)
         .style("stroke", "#999")
         .style("stroke-width", 1);
      d3.selectAll(".node text") 
          .style("font-weight", "normal")
          .style("font-size", "14px")
          .style("opacity", 1);

      d3.selectAll(".edge path")  
          .style("opacity", 1); 

      // HIGHLIGHT the vertex clicked
      d3.select(this)
          .style("opacity", .8)     
          .style("stroke", "#ED553B")
          .style("stroke-width", 4);


      d3.select(this)
            .transition(400)
            .attr("transform", "scale(1.1)")
            .style("opacity", .8);

      // console.log(d3.select(this)[0][0].parentNode);
      // console.log(d3.select(this.parentNode));
      
      d3.select(this.parentNode).selectAll("text")
                                .transition(400)
                                // .style("font-size", "16px")
                                .style("font-weight", "regular")
                                .style("opacity", 1);

        // console.log(function(u, value) {return graph.inEdges(d)});

/*        var findingEdgesId = graph.inEdges(u);
        d3.select("#"+ findingEdgesId)
          .attr("class", "selectedEdge");
          // .style("stroke-width", "4px")

        console.log(findingEdgesId);*/

     });
     

// +info here http://www.trendskitchens.co.nz/jquery/contextmenu/
// CONTEXT MENU

   //right click menu items
    $("g.nodes").contextMenu("cntxtMenu",
    {
        itemStyle: {
            fontFamily : "sans-serif",
            fontSize: "12px",
       
/*            backgroundColor : "#666",
            color: "white",*/
            border: "none",
            padding: "0px"
        },
         shadow: false,

         itemHoverStyle: {
            // color: "#fff",
            backgroundColor: "lightgrey",
            border: "none"
        },

        bindings:
        {
            "neighbour": function(u) {

                //GRAPH Features Possibilities
                idNeighborsVertex = graph.neighbors(mySelectionCMenu)
                console.log("idNeighborsVertex", idNeighborsVertex) 

                return d3.selectAll(".node.enter")
                            .filter(function(d) { 
                                selectingThis = d3.select(this)
                                selectingThisId = selectingThis.attr("id")

                                myArray = idNeighborsVertex

                                //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                                if (myArray.indexOf(selectingThisId) >= 0)  {
                                                                            
                                    console.log("selectingThisId", selectingThisId)  
                                    selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  // .style("fill", "orange")
                                                  .style("opacity", .8);         
                                
                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .8);
                               
                                //SelectingThis edges filtering
                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)
                                console.log("mySelectionCMenu", mySelectionCMenu)
                                console.log("incidentEdgesmySelectionCMenu", incidentEdgesmySelectionCMenu)

                                d3.selectAll(".edgePath.enter")
                                            .filter(function(d) {
                                              selectingThis = d3.select(this)
                                              selectingThisId = selectingThis.attr("id")

                                              if (incidentEdgesmySelectionCMenu.indexOf(selectingThisId) >= 0)  {
                                              selectingThis.selectAll("path")
                                                          // .style("fill", "purple")
                                                          .style("opacity", 1); 
                                              }
                                            })                                                                 
                                }

                                else {       
                                        selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  .style("opacity", .1);      
                                        selectingThis.selectAll("text")
                                                  .transition(400)
                                                  // .attr("text-anchor", "middle")
                                                  .style("opacity", .1); 


                                //SelectingThis edges filtering
                                dismissedNodes = selectingThis.attr("id");
                                incidentEdges = graph.incidentEdges(dismissedNodes)

                                d3.selectAll("#"+incidentEdges).selectAll("path")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .2);                                                   

                                console.log("blabla", incidentEdges);
                                d3.selectAll("#pathOuter"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);     

                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)

                                d3.selectAll("#"+incidentEdgesmySelectionCMenu).selectAll("path")
                                          .transition(400)
                                          .style("opacity", 1); 
                                
                                d3.selectAll("#pathOuter"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);  


                                /////


                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .8); 

                                d3.select("#"+mySelectionCMenu).selectAll("text")
                                .transition(400)
                                // .style("font-size", "16px")
                                .style("font-weight", "regular")
                                .style("opacity", 1); 
                                 };             
                            })
                  

            },

            "predecessors": function(d) {
                
                //GRAPH Features Possibilities
                idPredecessorsVertex = graph.predecessors(mySelectionCMenu)
                console.log("idPredecessorsVertex", idPredecessorsVertex) 

                  return d3.selectAll(".node.enter")
                            .filter(function(d) { 
                                selectingThis = d3.select(this)
                                selectingThisId = selectingThis.attr("id")

                                myArray = idPredecessorsVertex

                                //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                                if (myArray.indexOf(selectingThisId) >= 0)  {
                                                                            
                                    console.log("selectingThisId", selectingThisId)  
                                    selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  // .style("fill", "orange")
                                                  .style("opacity", .8);         
                                
                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .8);
                               
                                //SelectingThis edges filtering
                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)
                                console.log("mySelectionCMenu", mySelectionCMenu)
                                console.log("incidentEdgesmySelectionCMenu", incidentEdgesmySelectionCMenu)

                                d3.selectAll(".edgePath.enter")
                                            .filter(function(d) {
                                              selectingThis = d3.select(this)
                                              selectingThisId = selectingThis.attr("id")

                                              if (incidentEdgesmySelectionCMenu.indexOf(selectingThisId) >= 0)  {
                                              selectingThis.selectAll("path")
                                                          // .style("fill", "purple")
                                                          .style("opacity", 1); 
                                              }
                                            })                                                                 
                                }

                                else {       
                                        selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  .style("opacity", .1);      
                                        selectingThis.selectAll("text")
                                                  .transition(400)
                                                  // .attr("text-anchor", "middle")
                                                  .style("opacity", .1); 


                                //SelectingThis edges filtering
                                dismissedNodes = selectingThis.attr("id");
                                incidentEdges = graph.incidentEdges(dismissedNodes)

                                d3.selectAll("#"+incidentEdges).selectAll("path")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .2);                                                   

                                console.log("blabla", incidentEdges);
                                d3.selectAll("#pathOuter"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);     

                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)

                                d3.selectAll("#"+incidentEdgesmySelectionCMenu).selectAll("path")
                                          .transition(400)
                                          .style("opacity", 1); 
                                
                                d3.selectAll("#pathOuter"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);  


                                /////


                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .8); 

                                d3.select("#"+mySelectionCMenu).selectAll("text")
                                .transition(400)
                                // .style("font-size", "16px")
                                .style("font-weight", "regular")
                                .style("opacity", 1); 
                                 };             
                            })
                  

            },

            "strongly-connected": function(d) {
            
            idStronglyConnected0 = tarjan(graph);
            console.log("idStronglyConnected0", idStronglyConnected0);
            console.log("idStronglyConnected0.length", idStronglyConnected0.length);
            
            // idStronglyConnected = idStronglyConnected0[1];
            // console.log("idStronglyConnected", idStronglyConnected);

            for (i = 0, longitud = idStronglyConnected0.length; i < longitud; i++){
            idStronglyConnected = tarjan(graph)[[i]]
             console.log("idStronglyConnectedOK", idStronglyConnected);

            }

            return d3.selectAll(".node.enter")
                            .filter(function(d) { 
                                selectingThis = d3.select(this)
                                selectingThisId = selectingThis.attr("id")
                                // console.log("selectingThisId", selectingThisId);

                                mySelection = d3.select("#"+mySelectionCMenu);
                                // console.log("mySelection", mySelection);
                                // console.log("mySelectionCMenu", mySelectionCMenu);

                                myArray = idStronglyConnected;

                                //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                                if (myArray.indexOf(mySelectionCMenu) >= 0)  {
                                  if (myArray.indexOf(selectingThisId) >= 0)  {

                                    console.log("cumplo condicion!", mySelectionCMenu);  
                                    selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  // .style("fill", "orange")
                                                  .style("opacity", .8);         
                                
                                    d3.select("#"+mySelectionCMenu).selectAll("rect")
                                              .transition(400)
                                              // .style("fill", "yellow")
                                              .style("opacity", .8);

                                //SelectingThis edges filtering
                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)
                                console.log("mySelectionCMenu", mySelectionCMenu)
                                console.log("incidentEdgesmySelectionCMenu", incidentEdgesmySelectionCMenu)

                                d3.selectAll(".edgePath.enter")
                                            .filter(function(d) {
                                              selectingThis = d3.select(this)
                                              selectingThisId = selectingThis.attr("id")

                                              if (incidentEdgesmySelectionCMenu.indexOf(selectingThisId) >= 0)  {
                                              selectingThis.selectAll("path")
                                                          // .style("fill", "purple")
                                                          .style("opacity", 1); 
                                              }
                                            })   

                                  }

                                  else {  
                                    // console.log("no cumplo condicion", selectingThisId); 
                                    selectingThis.selectAll("rect")
                                              .transition(400)
                                              .style("opacity", .1);      
                                    selectingThis.selectAll("text")
                                              .transition(400)
                                              // .attr("text-anchor", "middle")
                                              .style("opacity", .1); 

                                    d3.select("#"+mySelectionCMenu).selectAll("rect")
                                              .transition(400)
                                              // .style("fill", "green")
                                              .style("opacity", .8); 

                                    d3.select("#"+mySelectionCMenu).selectAll("text")
                                    .transition(400)
                                    // .style("font-size", "16px")
                                    .style("font-weight", "regular")
                                    .style("opacity", 1); 
                                     };   
                                }
                              
                              else {  
                                // console.log("no cumplo condicion", selectingThisId); 
                                selectingThis.selectAll("rect")
                                          .transition(400)
                                          .style("opacity", .1);      
                                selectingThis.selectAll("text")
                                          .transition(400)
                                          // .attr("text-anchor", "middle")
                                          .style("opacity", .1); 

                                
                                //SelectingThis edges filtering
                                dismissedNodes = selectingThis.attr("id");
                                incidentEdges = graph.incidentEdges(dismissedNodes)

                                d3.selectAll("#"+incidentEdges).selectAll("path")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .2);                                                   

                                console.log("blabla", incidentEdges);
                                d3.selectAll("#pathOuter"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);     

                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)

                                d3.selectAll("#"+incidentEdgesmySelectionCMenu).selectAll("path")
                                          .transition(400)
                                          .style("opacity", 1); 
                                
                                d3.selectAll("#pathOuter"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);  


                                /////

                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .8); 

                                d3.select("#"+mySelectionCMenu).selectAll("text")
                                .transition(400)
                                // .style("font-size", "16px")
                                .style("font-weight", "regular")
                                .style("opacity", 1); 
                                 };   

                            })
                
            },
            
            "successors": function(d) {
               
                //GRAPH Features Possibilities
                idSuccessorsVertex = graph.successors(mySelectionCMenu)
                console.log(idSuccessorsVertex) 

                                 return d3.selectAll(".node.enter")
                            .filter(function(d) { 
                                selectingThis = d3.select(this)
                                selectingThisId = selectingThis.attr("id")

                                myArray = idSuccessorsVertex

                                //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                                if (myArray.indexOf(selectingThisId) >= 0)  {
                                                                            
                                    console.log("selectingThisId", selectingThisId)  
                                    selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  // .style("fill", "orange")
                                                  .style("opacity", .8);         
                                
                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .8);
                               
                                //SelectingThis edges filtering
                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)
                                console.log("mySelectionCMenu", mySelectionCMenu)
                                console.log("incidentEdgesmySelectionCMenu", incidentEdgesmySelectionCMenu)

                                d3.selectAll(".edgePath.enter")
                                            .filter(function(d) {
                                              selectingThis = d3.select(this)
                                              selectingThisId = selectingThis.attr("id")

                                              if (incidentEdgesmySelectionCMenu.indexOf(selectingThisId) >= 0)  {
                                              selectingThis.selectAll("path")
                                                          // .style("fill", "purple")
                                                          .style("opacity", 1); 
                                              }
                                            })                                                                 
                                }

                                else {       
                                        selectingThis.selectAll("rect")
                                                  .transition(400)
                                                  .style("opacity", .1);      
                                        selectingThis.selectAll("text")
                                                  .transition(400)
                                                  // .attr("text-anchor", "middle")
                                                  .style("opacity", .1); 


                                //SelectingThis edges filtering
                                dismissedNodes = selectingThis.attr("id");
                                incidentEdges = graph.incidentEdges(dismissedNodes)

                                d3.selectAll("#"+incidentEdges).selectAll("path")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .2);                                                   

                                console.log("blabla", incidentEdges);
                                d3.selectAll("#pathOuter"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdges)
                                          .transition(400)
                                          // .style("fill", "yellow")
                                          .style("opacity", .1);     

                                incidentEdgesmySelectionCMenu = graph.incidentEdges(mySelectionCMenu)

                                d3.selectAll("#"+incidentEdgesmySelectionCMenu).selectAll("path")
                                          .transition(400)
                                          .style("opacity", 1); 
                                
                                d3.selectAll("#pathOuter"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);                                                   
                                d3.selectAll("#pathOuter2"+incidentEdgesmySelectionCMenu)
                                          .transition(400)
                                          // .style("fill", "red")
                                          .style("opacity", 1);  


                                /////


                                d3.select("#"+mySelectionCMenu).selectAll("rect")
                                          .transition(400)
                                          // .style("fill", "green")
                                          .style("opacity", .8); 

                                d3.select("#"+mySelectionCMenu).selectAll("text")
                                .transition(400)
                                // .style("font-size", "16px")
                                .style("font-weight", "regular")
                                .style("opacity", 1); 
                                 };             
                            })
                  

            },

        }
    });

//////////////////////////////////////////////////


  // Implemented: now on click 
  d3.selectAll(".node rect")
       .on("click", function(u, value) {



        graph.addNode("A", {label: "s label"});
        graph.addNode("b", {label: "a label"});
        graph.addNode("console", {label: "a s"});
        graph.addNode("d", {label: "a label"});

        graph.addNode("lALALALALA", {label: "lALALALALA", module:"goo", propertyTypes:"id, lalala"});
        console.log("All graph vertex: " + graph.nodes());
        // graph.addEdge(null, "A", selected2Id,  {label: "labelll fake"});
        
/*        graph.addEdge("id-blabla?", "A", selected2Id,  {u:"A", v: selected2Id, inArity:"one", outArity:"many", label: "labelll fake", module:"blabla", propertyTypes:"X"});
        // graph.addEdge(null, "A", "lALALALALA");

        // graph.delNode("GoSlims")*/
        console.log("All graph vertex: " + graph.nodes());

///////////////////////////// AGAIN MAIN LAYOUT FUNCTIONS?

  //alter the drawEdges function:
/*  var oldDrawEdge = renderer.drawEdgePaths();
  renderer.drawEdgePaths(function(graph, root) {

    console.log(d3.selectAll("svgEdgePaths"));

    var svgEdgePaths = oldDrawEdge(graph, root);
    svgEdgePaths.attr("id", function(e) { return  e })
    return svgEdgePaths;

  });*/



  // Handle debugAlignment
      renderer.postLayout(function(graph) {
        if (debugAlignment) {
          // First find necessary delta...
          var minX = Math.min.apply(null, graph.nodes().map(function(u) {
            var value = graph.node(u);
            return value[debugAlignment] - value.width / 2;
          }));

          // Update node positions
          graph.eachNode(function(u, value) {
            value.x = value[debugAlignment] - minX;
          });

          // Update edge positions
          graph.eachEdge(function(e, u, v, value) {
            value.points.forEach(function(p) {
              p.x = p[debugAlignment] - minX;
            });
          });
        }
      });

  //Configuring the layout:
  var layout = dagreD3.layout()
                //.nodeSep(50)  //50=default
                //.edgeSep(10)
                //.rankSep(20);   //Separation between levels, childs
                .rankDir("LR"); //TB:top-to-bottom / BT:bottom-to-top / LR:left-to-right / RL:right-to-left 

  // Custom transition function
  function transition(selection) {
    return selection.transition().duration(1000);
  }

  renderer.transition(transition).run(graph, svgGraph.select("g"));


  //Configuring the renderer-original:
/*  var renderinglayout = renderer.layout(layout)
              // .data([0,1])
              // .edgeTension(function(d,i) {return (i*.5)})
              // .edgeTension(.5)
              .edgeInterpolate("bundle")  // Bundle, linear, step-after, basis, cardinal, monotone..
              // .transition(500)
              .zoom(false)
              // .transition()
              .run(graph, svgGraph.select("g"));*/

d3.selectAll(".edgePath path")
    .style("stroke", "red");

d3.selectAll(".node rect")
    .style("fill", "red");





    // Zoom and scale to fit
/*    var zoomScale = zoom.scale();
    var graphWidth = renderinglayout.graph().width + 80;
    var graphHeight = renderinglayout.graph().height + 40;

    console.log("graphWidth", graphWidth);
    
    var width = parseInt(svg.style('width').replace(/px/, ''));
    var height = parseInt(svg.style('height').replace(/px/, ''));
    
    zoomScale = Math.min(width / graphWidth, height / graphHeight);
    
    var translate = [(width/2) - ((graphWidth*zoomScale)/2), (height/2) - ((graphHeight*zoomScale)/2)];
    zoom.translate(translate);
    zoom.scale(zoomScale);
    zoom.event(svg.transition().duration(1000));*/



























          // UPDATE to normal status
          d3.selectAll(".node rect")
             .style("fill", "teal")
             .style("opacity", .4)
             .style("stroke", "#999")
             .style("stroke-width", 1);
          d3.selectAll(".node text") 
              .style("font-weight", "normal")
              .style("font-size", "14px")
              .style("opacity", 1);

          // HIGHLIGHT the vertex clicked
          d3.select(this)
            .style("stroke", "brown")
            .style("stroke-width", 4);

          idNeighborsVertex = graph.neighbors(u)
          console.log(idNeighborsVertex) 

          d3.selectAll(".node.enter")
            .filter(function(d) { 
                selectingThis = d3.select(this)
                selectingThisId = selectingThis.attr("id")

                myArray = idNeighborsVertex
                
                //Array Based method with `indexOf` to see whether the value matches one of the values in the array
                if (myArray.indexOf(selectingThisId) >= 0)  {
                    
                    // console.log(selectingThisId)  
                    selectingThis.selectAll("rect")
                                  .transition(400)
                                  .style("fill", "orange")
                                  .style("opacity", .8);         

                }
                
                // else { console.log("buuu") }              // WORKS!! :D
                else { selectingThis.selectAll("rect")
                                  .transition(400)
                                  .style("opacity", .1);      
                        selectingThis.selectAll("text")
                                  .transition(400)
                                  // .attr("text-anchor", "middle")
                                  .style("opacity", .1);      
                 };             
            })

          
          d3.select(this)
                .transition(400)
                .style("opacity", .8);

          // console.log(d3.select(this)[0][0].parentNode);
          // console.log(d3.select(this.parentNode));
          
          d3.select(this.parentNode).selectAll("text")
                                    .transition(400)
                                    // .style("font-size", "16px")
                                    .style("font-weight", "bold")
                                    .style("opacity", 1);
         
          // d3.select(this)[0][0].parentNode.select(this).selectAll("text")


          
           // console.log(d3.select(this)[0][0].parentNode.select(this))



        

        });

















// ----------------------- >
// TO DO: implement this with click on events :D



/*      // .each( function(d, i) {
      .selectAll("rect")
      .style("fill", "green");      */
      


/*    .each( function(d, i) {
        idSelection = d3.select(this).attr("id");
    
        d3.selectAll("#"+idSelection)          
          .selectAll("rect")
          .style("fill", "brown");                 
    });*/



/*    d3.selectAll(".node rect")
         .on("click", function(u, value) {
             console.log( "\n" + "Vertex '" + u + "'\n" + "My neighbors nodes are '" + graph.neighbors(u) + "'" + "\n" + "Module: '" + graph.node(u).module + "' & PropertyTypes: '" + graph.node(u).propertyTypes + "'")
          });*/
    

/*    d3.selectAll(".node rect").each
         .on("click", function(d, i) {
         // .on("click", function(u) {

              myNeighbor = graph.neighbors(u);
              
              idNeighbors = d3.select(myNeighbor).attr("id");
              
              d3.selectAll("#"+idNeighbors)          
                .selectAll("rect")
                .style("fill", "brown");              // DOESNT WORK
              
          });*/

/*    d3.selectAll(".node rect").each
         .on("click", dosomething });

    dosomething      function(u) {
              
              myNeighbor = graph.neighbors(u);
              
              idNeighbors = d3.select(myNeighbor).attr("id");
              
              d3.selectAll("#"+idNeighbors)          
                .selectAll("rect")
                .style("fill", "brown");              // DOESNT WORK
              
          });
*/
 /*        ------> function nodeclick 
            iddd = graph.successors(u);
            d3.selectAll("#"+iddd)          
              .selectAll("rect")
              .style("fill", "red");  
          });


    d3.selectAll(".node.enter")
         .on("click", nodeclick);*/


/*
    d3.selectAll(".node.enter")
         .on("click", function(u) {
            iddd = graph.successors(u);
            d3.selectAll("#"+iddd)          
              .selectAll("rect")
              .style("fill", "red");  
          });
*/


/*    d3.selectAll(".node rect")
         .on("click", function(u, value) {
             d3.selectAll(graph.neighbors(u))
                    .style("stroke", "red")
          });*/

/*    // Accessing to attributes/classes -- WORKS
    d3.selectAll(".node.enter")
         .on("click", function(u, value) {
            if(d3.select(this).attr("id") == "GoTerm") {
              return console.log("yes, I am " + d3.select(this).attr("id") ) 
            }
            else { return console.log("no,  I am not GoTerm" )
            }
          // All this if/else code is equivalent to this single line:
          // return d3.select(this).attr("id") == "GoTerm" ? console.log("yes") : console.log("no")
          });
*/


/*    // Reading attributes/classes -- WORKS
    d3.selectAll(".node.enter")
         .on("click", function(u, value) {
              var ll = d3.select(this)
              console.log( ll.attr("propertyTypes") + ll.attr("label") + ll.attr("style") )
                      
          });*/

/*
    d3.selectAll(".node rect")
         .on("mouseover", function(){ 
                d3.select(this)
                  .attr("width", 100)
                  .attr("heigh", 100)
         });*/

/*    d3.selectAll(".node rect")
         .on("mouseover", function(){ 
                var ww = d3.select(this).attr("width")
                
                d3.select(this)
                  .attr("width", (+ww + 20))
         });*/

    d3.selectAll(".edgePath path")
         .on("click", function(e, u, v, value) {
             alert("Edge '" + e + "'\n" + "Source: '" + graph.source(e) + "' -> Target: '" + graph.target(e) + "'" + "'\n" + "\n" + "Module: '" + graph.edge(e).module + "'' , PropertyTypes: '" + graph.edge(e).propertyTypes + "' & inArity/OutArity: '" + graph.edge(e).inArity + "/" + graph.edge(e).outArity + "'");
         })
         .style("stroke", "lightgrey");

/*    d3.selectAll("[id=GoTerm]")
          .selectAll("rect")
          .style("fill", "brown");*/

/*    // d3.selectAll("[outArity=one]") // Something wrong when selecting EDGE PATHS instead of vertex, doesnt do anything!
    d3.selectAll("#PositivelyRegulates")
          // .selectAll("path")
          .style("fill", "red")
          .style("stroke", "blue");*/


// Returning a specif atribute of a variable
/*d3.select("body")
    .on("mouseover", function(){ 
          if (d3.select(this).attr("id") == "correct") {
              enableInteraction(d3.select(this));
          }
});*/


//all work in progress ---->>

/*  // TEST2
    // nodes on click! 
    d3.selectAll(".node rect")
         .on("click", function(u, value) {
             alert("Vertex '" + u + "'\n" + "My neighbors nodes are '" + graph.neighbors(u) + "'" + "'\n" + "\n" + "Module: '" + graph.node(u).module + "' & PropertyTypes: '" + graph.node(u).propertyTypes + "'");
         })*/


    //Starting some trials





/*  //Show some vertex-info while hovering or clicking...
   d3.selectAll(".node rect")
    .append("svg:text")
    .attr("class", "nodetext")
    .attr("dx", 12)
    .attr("dy", ".35em")
    .text("lala");
   */ // .text(function(d) { return d.name });


/*    RouteMap.selectAll("text")
         .data(graph)
         .enter()
         .append("text")
         .text(function(d) {
            return d.source;
         })
         .attr("text-anchor", "middle")
         .attr("x", 20)
         .attr("y", 30)
         .attr("font-family", "sans-serif")
         .attr("font-size", "11px")cd
         .attr("fill", "red");
*/


// ROUTE MAP:

svgRouteMap = d3.select("svg#svg-routemap");

RouteMap = svgRouteMap.select("g")
                      .append("g")
                      .attr("id", "RouteMap");


/*    d3.selectAll(".node.enter")
      //On click, update with new data      
        .on("click", function() { 

          // doesn't work well, all the time shows the first ite "GoTerm"
            d3.select("body")
                .data(newVertex)
                // .enter()
                .append("p")
                .style("color", "teal")
                // .text("lalala")
                .text(function(d) { return d.value.label })
                // .attr("x", function(d, i) { return (10*i) + 100; })
                .attr("x", 100)
                .attr("y", 100)
              });*/

/*    d3.selectAll(".node.enter")
      //On click, update with new data      
        .on("click", function(d) { 

          // doesn't work well, all the time shows the first ite "GoTerm"
            d3.select("this").select("text")
                            .text(function(d) { 
                              return d.value.label })
                            .style("font-size","20px")
                            .style("color", "teal")

                            .attr("x", 100)
                            .attr("y", 100)
              });*/


/*          svgRouteMap.append("text")
                      .attr("text-anchor", "middle")
                      .attr("fill", "red")
                      .text(function(u) { return u; })
                      .attr("x", 100)
                      .attr("y", 100)
                    });
*/



/*        d3.selectAll(".node.enter")
      //On click, update with new data     
      .on("click", function(u, value) { return
        
        select(this).append("p")    
         .text(function(u) { return u; })
         .attr("font-family", "sans-serif")
         .attr("font-size", "10px")
         .attr("fill", "teal")
         .attr("x", function(d, i) { return (10*i) + 100; })
         .attr("y", 100);

       });*/


/*        d3.selectAll(".node.enter")
      //On click, update with new data     
        
         .append("p")    
         .text(function(u) { return u; })
         .attr("font-family", "sans-serif")
         .attr("font-size", "10px")
         .attr("fill", "teal")
         .attr("x", function(d, i) { return (10*i) + 100; })
         .attr("y", 100);

       });
*/



/*          //New values for dataset
          var numValues = dataset.length;               //Count original length of dataset
          var maxRange = Math.random() * 1000;            //Max range of new values
          dataset = [];                         //Initialize empty array
          for (var i = 0; i < numValues; i++) {           //Loop numValues times
            var newNumber1 = Math.floor(Math.random() * maxRange);  //New random integer
            var newNumber2 = Math.floor(Math.random() * maxRange);  //New random integer
            dataset.push([newNumber1, newNumber2]);         //Add new number to array
          }*/
        
  });
  }

</script>


